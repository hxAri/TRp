
name: "price-tracker"
on:
    push:
        branches:
        -	main
    schedule:
    #        You can use https://crontab.guru to help generate
    #        your cron syntax and confirm what time it will run
    #
    #        ┌───────────── minute 0, 30
    #        │    ┌───────────── hour (0 - 23)
    #        │    │ ┌───────────── day of the month (1 - 31)
    #        │    │ │ ┌───────────── month (1 - 12 or JAN-DEC)
    #        │    │ │ │ ┌───────────── day of the week (0 - 6 or SUN-SAT)
    #        │    │ │ │ │
    #        0,30 * * * *
    -   cron: "0,30 * * * *"
jobs:
    tracker:
        runs-on: ubuntu-latest
        steps:
        -   uses: actions/checkout@v3
        -   uses: actions/setup-python@v4
            with:
                python-version: 3.11
                cache: pip
        -   run: pip install -r requirements.txt
        -   name: Pulling API progress
            run: |
                export PYTHONPATH=.:$PYTHONPATH
                python3 src/main
        -   name: Patching changes progress
            run: |
                now=$(date +"%Y-%m-%d %H:%I")
                git config --global user.name hxari
                git config --global user.email 90847846+hxAri@users.noreply.github.com
                git add ./data
                git commit -m "[bot] patching progress at ${now}" || echo -e "Nothing to commit"
                git push || echo "Nothing to push"